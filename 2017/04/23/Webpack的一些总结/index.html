<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
    
  
  <link href="https://cdn.staticfile.org/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Webpack," />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.1" />






<meta name="description" content="webpack的一些基本操作1. webpack 基本介绍 webpack 作为当前最为流行的前端模块化打包工具 可以通过快速建立应用程序的依赖图表并以正确顺序打包他们来简化你的工作流，通过针对性的配置对webpack进行自定义优化配置，比如为生产环境拆分vendor/css/js 代码， 通过运行开发服务器来实现无刷新热重载等一系列功能。">
<meta name="keywords" content="Webpack">
<meta property="og:type" content="article">
<meta property="og:title" content="Webpack的一些总结">
<meta property="og:url" content="http://yoursite.com/2017/04/23/Webpack的一些总结/index.html">
<meta property="og:site_name" content="Lztylionheart的小站">
<meta property="og:description" content="webpack的一些基本操作1. webpack 基本介绍 webpack 作为当前最为流行的前端模块化打包工具 可以通过快速建立应用程序的依赖图表并以正确顺序打包他们来简化你的工作流，通过针对性的配置对webpack进行自定义优化配置，比如为生产环境拆分vendor/css/js 代码， 通过运行开发服务器来实现无刷新热重载等一系列功能。">
<meta property="og:updated_time" content="2017-04-23T00:18:32.326Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Webpack的一些总结">
<meta name="twitter:description" content="webpack的一些基本操作1. webpack 基本介绍 webpack 作为当前最为流行的前端模块化打包工具 可以通过快速建立应用程序的依赖图表并以正确顺序打包他们来简化你的工作流，通过针对性的配置对webpack进行自定义优化配置，比如为生产环境拆分vendor/css/js 代码， 通过运行开发服务器来实现无刷新热重载等一系列功能。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'D58RT6DJMI',
      apiKey: '7196064c16165d6cc38424261b927fbe',
      indexName: 'lzty_blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/04/23/Webpack的一些总结/"/>





  <title>Webpack的一些总结 | Lztylionheart的小站</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3200355479f8d61fffe5f77cff0c4442";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Lztylionheart的小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/23/Webpack的一些总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lztylionheart">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://of7y9dyoj.bkt.clouddn.com/118869CA35D08F23C978E7A0C021E8CE.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lztylionheart的小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                Webpack的一些总结
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-23T08:06:42+08:00">
                2017-04-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/04/23/Webpack的一些总结/" class="leancloud_visitors" data-flag-title="Webpack的一些总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="webpack的一些基本操作"><a href="#webpack的一些基本操作" class="headerlink" title="webpack的一些基本操作"></a>webpack的一些基本操作</h1><h2 id="1-webpack-基本介绍"><a href="#1-webpack-基本介绍" class="headerlink" title="1. webpack 基本介绍"></a>1. <code>webpack</code> 基本介绍</h2><ol>
<li><code>webpack</code> 作为当前最为流行的前端模块化打包工具 可以通过快速建立应用程序的依赖图表并以正确顺序打包他们来简化你的工作流，通过针对性的配置对<code>webpack</code>进行自定义优化配置，比如为生产环境拆分<code>vendor/css/js</code> 代码， 通过运行开发服务器来实现无刷新热重载等一系列功能。<a id="more"></a></li>
<li><p>创建一个示例目录尝试<code>webpack</code></p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">		mkdir webpack-demo &amp;&amp; webpack-demo</div><div class="line">		npm init -y</div><div class="line">		npm install --save-dev webpack</div><div class="line">	```  </div><div class="line"></div><div class="line">	创建app目录 并新建一个`index.js`文件</div><div class="line"></div><div class="line">	``` shell</div><div class="line">	function component () &#123;</div><div class="line">			var element = document.createElement('div');</div><div class="line"></div><div class="line">			/* 需要引入lodash， 下一行才能正常工作 */</div><div class="line">			element.innerHTML = _.join(['Hello','webpack'], ' ');</div><div class="line"></div><div class="line">			return element;</div><div class="line"></div><div class="line">	&#125;</div><div class="line">	document.body.appendChild(component());</div><div class="line"> ```  </div><div class="line"><span class="meta"> </span></div><div class="line">## 要运行这段代码 通常需要一下`html`:</div><div class="line"><span class="meta"></span></div><div class="line">	### index.html</div><div class="line">	``` shell</div><div class="line">	&lt;!DOCTYPE html&gt;</div><div class="line">	&lt;html&gt;</div><div class="line">		&lt;head&gt;</div><div class="line">			&lt;meta charset="utf-8"&gt;</div><div class="line">			&lt;title&gt;webpack demo&lt;/title&gt;</div><div class="line">			&lt;script type="text/javascript" src="https://unpkg.com/lodash@4.16.6"&gt;&lt;/script&gt;</div><div class="line">		&lt;/head&gt;</div><div class="line">		&lt;body&gt;</div><div class="line">			&lt;script type="text/javascript" src="app/index.js"&gt;&lt;/script&gt;</div><div class="line">		&lt;/body&gt;</div><div class="line">	&lt;/html&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>### 这个示例中 `&lt;script&gt;` 标签之间存在隐式依赖关系

  ### 运行`index.js` 的前提是必须依赖提前引入的`lodash`。 之所以说是隐式是因为index.js 并未显式申明需要引入`ladash`, 只能假定推测已经存在一个全局变量`_`。

### 使用这种方法去管理javascript 项目会有一些问题：

*  如果依赖不存在， 或者引入顺序错误， 应用程序将无法正常运行。
*  如果依赖被引入但是并没有没使用, 那样就会存在浏览器下载了无用代码。

### 要在 `index.js` 中打包 `lodash`依赖,  首先我们需要安装 `lodash`。

  <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save lodash</div></pre></td></tr></table></figure>


  ### 然后引入（import）它。
  ### app/index.js
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ import _ from 'lodash';</div></pre></td></tr></table></figure>


  ### 之后修改`index.html`, 来引入打包好的单个`js` 文件。

  <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">	&lt;html&gt;</div><div class="line">		&lt;head&gt;</div><div class="line">			&lt;meta charset="utf-8"&gt;</div><div class="line">			&lt;title&gt;webpack demo&lt;/title&gt;</div><div class="line">			&lt;!-- &lt;script type="text/javascript" src="https://unpkg.com/lodash@4.16.6"&gt;&lt;/script&gt; --&gt;</div><div class="line">		&lt;/head&gt;</div><div class="line">		&lt;body&gt;</div><div class="line">			&lt;script src="dist/bundle.js"&gt;&lt;/script&gt;</div><div class="line">		&lt;/body&gt;</div><div class="line">	&lt;/html&gt;</div><div class="line">```  </div><div class="line">   </div><div class="line"><span class="meta">#</span>## 	在这里 `index.js` 显示要求引入的`lodash`必须存在，然后他将以`_`的别名绑定(不会造成全局范围变量污染)。</div><div class="line">   </div><div class="line"><span class="meta">#</span>## 通过声明模块所需的依赖，`webpack` 能够利用这些信息去构建依赖图表，然后使用图表生成一个优化过的，会以正确代码顺序被运行的 `bundle`。并且没有用到的依赖将不会被 `bundle` 引入。</div><div class="line">   </div><div class="line"><span class="meta">#</span>## 现在在此文件夹下带上以下参数运行 `webpack`，其中 `index.js` 是入口文件，`bundle.js` 是已打包所需的所有代码的输出文件。</div><div class="line">   </div><div class="line">``` shell</div><div class="line"><span class="meta">$</span> webpack app/index.js dist/bundle.js</div><div class="line">Hash: 8127988a792147791f3d</div><div class="line">Version: webpack 2.3.3</div><div class="line">Time: 437ms</div><div class="line">	Asset    Size  Chunks                    Chunk Names</div><div class="line">bundle.js  544 kB       0  [emitted]  [big]  main</div><div class="line">	[0] ./~/.4.17.4@lodash/lodash.js 540 kB &#123;0&#125; [built]</div><div class="line">	[1] ./app/index.js 260 bytes &#123;0&#125; [built]</div><div class="line">	[2] (webpack)/buildin/global.js 509 bytes &#123;0&#125; [built]</div><div class="line">	[3] (webpack)/buildin/module.js 517 bytes &#123;0&#125; [built]</div></pre></td></tr></table></figure>

### 在浏览器中打开 `index.html`, 查看吗构建成功的bundle的结果。你应该能看到带有以下文本的页面：‘Hello webpack’。
</code></pre><h2 id="1-1-在webpack中使用ES2015模块"><a href="#1-1-在webpack中使用ES2015模块" class="headerlink" title="1.1 在webpack中使用ES2015模块"></a>1.1 在<code>webpack</code>中使用<code>ES2015</code>模块</h2><ol>
<li><h3 id="在app-index-js-中-使用了ES2015模块-module-import-尽管import-export-并未在全部浏览器中支持-但依旧可以正常使用，因为webpack将会将其替换为ES5兼容的代码。"><a href="#在app-index-js-中-使用了ES2015模块-module-import-尽管import-export-并未在全部浏览器中支持-但依旧可以正常使用，因为webpack将会将其替换为ES5兼容的代码。" class="headerlink" title="在app/index.js 中 使用了ES2015模块(module import), 尽管import/ export 并未在全部浏览器中支持 但依旧可以正常使用，因为webpack将会将其替换为ES5兼容的代码。"></a>在<code>app/index.js</code> 中 使用了ES2015模块(module import), 尽管<code>import/ export</code> 并未在全部浏览器中支持 但依旧可以正常使用，因为<code>webpack</code>将会将其替换为<code>ES5</code>兼容的代码。</h3></li>
<li><h3 id="但webpack-不会更改除了-import-export除外的代码-如果需要使用ES6语法-请使用babel-转译器。"><a href="#但webpack-不会更改除了-import-export除外的代码-如果需要使用ES6语法-请使用babel-转译器。" class="headerlink" title="但webpack 不会更改除了 import / export除外的代码 如果需要使用ES6语法 请使用babel 转译器。"></a>但<code>webpack</code> 不会更改除了 <code>import / export</code>除外的代码 如果需要使用<code>ES6</code>语法 请使用<code>babel</code> 转译器。</h3><h2 id="1-2-使用带有配置的-webpack"><a href="#1-2-使用带有配置的-webpack" class="headerlink" title="1.2 使用带有配置的 webpack"></a>1.2 使用带有配置的 <code>webpack</code></h2></li>
<li><h3 id="对于复杂配置-我们可以使用一个配置文件-webpack会根据配置文件来打包代码创建一个-webpack-config-js"><a href="#对于复杂配置-我们可以使用一个配置文件-webpack会根据配置文件来打包代码创建一个-webpack-config-js" class="headerlink" title="对于复杂配置  我们可以使用一个配置文件 webpack会根据配置文件来打包代码创建一个 webpack.config.js"></a>对于复杂配置  我们可以使用一个配置文件 webpack会根据配置文件来打包代码创建一个 <code>webpack.config.js</code></h3><h3 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h3> <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var path = require('path');</div><div class="line">	module.exports = &#123;</div><div class="line">		entry: './app/index.js',</div><div class="line">		output: &#123;</div><div class="line">			filename: 'bundle.js',</div><div class="line">			path: path.resolve(__dirname, 'dist')</div><div class="line">		&#125;</div><div class="line">	&#125;;</div></pre></td></tr></table></figure>
<h3 id="此文件可以被webpack运行"><a href="#此文件可以被webpack运行" class="headerlink" title="此文件可以被webpack运行"></a>此文件可以被<strong>webpack</strong>运行</h3> <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> webpack --config webpack.config.js</div><div class="line">Hash: 8127988a792147791f3d</div><div class="line">Version: webpack 2.3.3</div><div class="line">Time: 388ms</div><div class="line">	Asset    Size  Chunks                    Chunk Names</div><div class="line">bundle.js  544 kB       0  [emitted]  [big]  main</div><div class="line">	[0] ./~/.4.17.4@lodash/lodash.js 540 kB &#123;0&#125; [built]</div><div class="line">	[1] ./app/index.js 260 bytes &#123;0&#125; [built]</div><div class="line">	[2] (webpack)/buildin/global.js 509 bytes &#123;0&#125; [built]</div><div class="line">	[3] (webpack)/buildin/module.js 517 bytes &#123;0&#125; [built]</div></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>如果存在 <strong>webpavk.config.js</strong>, <strong>webpack</strong> 命令将默认选择使用它.</p>
<p>删除上述<strong>bundle</strong>文件 重新执行脚本  验证输出内容</p>
</blockquote>
<h2 id="1-3-配合npm-使用"><a href="#1-3-配合npm-使用" class="headerlink" title="1.3 配合npm 使用"></a>1.3 配合npm 使用</h2><h3 id="考虑到用cli-这种方式来运行webpack-不是特别方便-可以设置快捷方式"><a href="#考虑到用cli-这种方式来运行webpack-不是特别方便-可以设置快捷方式" class="headerlink" title="考虑到用cli 这种方式来运行webpack 不是特别方便 可以设置快捷方式"></a>考虑到用cli 这种方式来运行webpack 不是特别方便 可以设置快捷方式</h3>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	...</div><div class="line">	"scripts": &#123;</div><div class="line">		"build": "webpack"</div><div class="line">	&#125;,</div><div class="line">	...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="现在你可以通过使用-npm-run-build，命令来实现与上面相同的效果，-npm-通过命令选取脚本，并临时修补执行环境，使脚本可以在运行时包含bin-命令-。-你可以在很多项目中看到这种使用习惯。"><a href="#现在你可以通过使用-npm-run-build，命令来实现与上面相同的效果，-npm-通过命令选取脚本，并临时修补执行环境，使脚本可以在运行时包含bin-命令-。-你可以在很多项目中看到这种使用习惯。" class="headerlink" title="现在你可以通过使用 npm run build，命令来实现与上面相同的效果， npm 通过命令选取脚本，并临时修补执行环境，使脚本可以在运行时包含bin 命令 。 你可以在很多项目中看到这种使用习惯。"></a>现在你可以通过使用 <code>npm run build</code>，命令来实现与上面相同的效果， npm 通过命令选取脚本，并临时修补执行环境，使脚本可以在运行时包含bin 命令 。 你可以在很多项目中看到这种使用习惯。</h3><blockquote>
<p>你可以通过向 <strong>npm run build</strong> 命令添加两个中横线， 给webpack传递自定义参数，例： <strong> npm run build – –colors </strong>.</p>
</blockquote>
<h2 id="2-安装"><a href="#2-安装" class="headerlink" title="2. 安装"></a>2. 安装</h2><ol>
<li><h3 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h3><h4 id="在开始前，-先要确认已安装Node-js的最新版本。建议使用最新LTS-使用旧版本-可能会遇到各种问题，-因为它们可能缺少webpack功能或缺少相关package包。"><a href="#在开始前，-先要确认已安装Node-js的最新版本。建议使用最新LTS-使用旧版本-可能会遇到各种问题，-因为它们可能缺少webpack功能或缺少相关package包。" class="headerlink" title="在开始前， 先要确认已安装Node.js的最新版本。建议使用最新LTS, 使用旧版本 可能会遇到各种问题， 因为它们可能缺少webpack功能或缺少相关package包。"></a>在开始前， 先要确认已安装Node.js的最新版本。建议使用最新<code>LTS</code>, 使用旧版本 可能会遇到各种问题， 因为它们可能缺少webpack功能或缺少相关package包。</h4></li>
<li><h3 id="本地安装"><a href="#本地安装" class="headerlink" title="本地安装"></a>本地安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm  install webpack --save-dev</div><div class="line">npm  install webpack@&lt;version&gt; --save-dev</div></pre></td></tr></table></figure>
<h4 id="如果你在项目中使用-npm-执行脚本-npm-首先会在你的本地模块中寻找webpack。"><a href="#如果你在项目中使用-npm-执行脚本-npm-首先会在你的本地模块中寻找webpack。" class="headerlink" title="如果你在项目中使用 npm 执行脚本 npm 首先会在你的本地模块中寻找webpack。"></a>如果你在项目中使用 npm 执行脚本 npm 首先会在你的本地模块中寻找webpack。</h4> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&quot;scripts&quot;: &#123;</div><div class="line">	&quot;start&quot;: &quot;webpack --config webpack.config.js&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="上面是npm的标准配置-也是我们推荐的实践。"><a href="#上面是npm的标准配置-也是我们推荐的实践。" class="headerlink" title="上面是npm的标准配置 也是我们推荐的实践。"></a>上面是npm的标准配置 也是我们推荐的实践。</h4><blockquote>
<p>当你在本地安装webpack后 你能够在 <em>node_modules/./bin/webpack</em> 中找到它的二进制程序。</p>
</blockquote>
</li>
<li><h3 id="全局安装-全局安装会锁定webpack到指定版本"><a href="#全局安装-全局安装会锁定webpack到指定版本" class="headerlink" title="全局安装(全局安装会锁定webpack到指定版本)"></a>全局安装(全局安装会锁定webpack到指定版本)</h3> <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install webpack -g</div></pre></td></tr></table></figure>
<h4 id="webpack-命令可以全局执行了"><a href="#webpack-命令可以全局执行了" class="headerlink" title="webpack 命令可以全局执行了."></a><code>webpack</code> 命令可以全局执行了.</h4></li>
<li><h3 id="体验最新版本"><a href="#体验最新版本" class="headerlink" title="体验最新版本"></a>体验最新版本</h3> <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install webpack/webpack#&lt;tagname/branchname&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="3-生产环境构建"><a href="#3-生产环境构建" class="headerlink" title="3. 生产环境构建"></a>3. 生产环境构建</h2><ol>
<li><h3 id="自动方式"><a href="#自动方式" class="headerlink" title="自动方式"></a>自动方式</h3><h4 id="运行webpack-p-也可以运行-webpack-optimize-minimize-define-process-enc-NODE-ENV-quot-39-production-39-quot-他们是等效的-。"><a href="#运行webpack-p-也可以运行-webpack-optimize-minimize-define-process-enc-NODE-ENV-quot-39-production-39-quot-他们是等效的-。" class="headerlink" title="运行webpack -p(也可以运行 webpack --optimize-minimize --define process.enc.NODE_ENV=&quot;&#39;production&#39;&quot;, 他们是等效的)。"></a>运行<code>webpack -p</code>(也可以运行 <code>webpack --optimize-minimize --define process.enc.NODE_ENV=&quot;&#39;production&#39;&quot;</code>, 他们是等效的)。</h4><ul>
<li>使用<code>UglifyJsPlugin</code> 进行JS 文件压缩;</li>
<li>运行 <code>LoaderOptionsPligin</code>;</li>
<li><p>设置Node环境变量。</p>
<h5 id="1-1-JS-文件压缩"><a href="#1-1-JS-文件压缩" class="headerlink" title="1.1 JS 文件压缩"></a>1.1 JS 文件压缩</h5><h6 id="webpack自带了-UglifyJsPlugin-运行UglifyJS-来压缩输出文具文件。-此插件支持所有的UglifyJS选项。在命令行中指定-–optimize-minimize-或在plugins配置中添加："><a href="#webpack自带了-UglifyJsPlugin-运行UglifyJS-来压缩输出文具文件。-此插件支持所有的UglifyJS选项。在命令行中指定-–optimize-minimize-或在plugins配置中添加：" class="headerlink" title="webpack自带了 UglifyJsPlugin, 运行UglifyJS 来压缩输出文具文件。 此插件支持所有的UglifyJS选项。在命令行中指定 –optimize-minimize 或在plugins配置中添加："></a>webpack自带了 <code>UglifyJsPlugin</code>, 运行<strong>UglifyJS</strong> 来压缩输出文具文件。 此插件支持所有的<strong>UglifyJS选项</strong>。在命令行中指定 –optimize-minimize 或在plugins配置中添加：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">const webpack = require(&apos;webpack);</div><div class="line">    module.exports = &#123;</div><div class="line">      /*...*/</div><div class="line">      plugins: [</div><div class="line">        new webpack.optimize.UglifyJsPlugin(&#123;</div><div class="line">        souceMap: options.devtool &amp;&amp; (options.devtool.indexOf(&quot;sourcemap&quot;) &gt;=0 || options.devtool.indexOf(&quot;soucre-map&quot;) &gt;=0)</div><div class="line">        &#125;)</div><div class="line">      ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><h3 id="Node环境变量"><a href="#Node环境变量" class="headerlink" title="Node环境变量"></a>Node环境变量</h3><h4 id="运行webpack-p-或者-define-process-env-NODE-ENV-quot-39-production-39-quot-会通过如下方式调用-DefinePlugin"><a href="#运行webpack-p-或者-define-process-env-NODE-ENV-quot-39-production-39-quot-会通过如下方式调用-DefinePlugin" class="headerlink" title="运行webpack -p(或者 --define process.env.NODE_ENV=&quot;&#39;production&#39;&quot;) 会通过如下方式调用 DefinePlugin"></a>运行<code>webpack -p</code>(或者 <code>--define process.env.NODE_ENV=&quot;&#39;production&#39;&quot;</code>) 会通过如下方式调用 <code>DefinePlugin</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">const webpack = require(&apos;webpack&apos;);</div><div class="line">module.exports = &#123;</div><div class="line">  /*...*/</div><div class="line">  plugins:[</div><div class="line">      new webpack.DefinePlugin(&#123;</div><div class="line">        &apos;process.env.NODE_ENV&apos;: JSON.stringify(&apos;production&apos;)</div><div class="line">      &#125;)</div><div class="line">  ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>「真诚赞赏，手留余香」</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="http://of7y9dyoj.bkt.clouddn.com/IMG_2055.JPG" alt="Lztylionheart WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="http://of7y9dyoj.bkt.clouddn.com/IMG_2059.JPG" alt="Lztylionheart Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Webpack/" rel="tag"># Webpack</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/04/22/一首老歌/" rel="prev" title="一首老歌">
                一首老歌 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8yODMyNi80ODk4"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://of7y9dyoj.bkt.clouddn.com/118869CA35D08F23C978E7A0C021E8CE.png"
               alt="Lztylionheart" />
          <p class="site-author-name" itemprop="name">Lztylionheart</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/LztyLionheart/" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/lzty280" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://fykyx521.iteye.com/" title="康师傅的博客" target="_blank">康师傅的博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#webpack的一些基本操作"><span class="nav-number">1.</span> <span class="nav-text">webpack的一些基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-webpack-基本介绍"><span class="nav-number">1.1.</span> <span class="nav-text">1. webpack 基本介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-在webpack中使用ES2015模块"><span class="nav-number">1.2.</span> <span class="nav-text">1.1 在webpack中使用ES2015模块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#在app-index-js-中-使用了ES2015模块-module-import-尽管import-export-并未在全部浏览器中支持-但依旧可以正常使用，因为webpack将会将其替换为ES5兼容的代码。"><span class="nav-number">1.2.1.</span> <span class="nav-text">在app/index.js 中 使用了ES2015模块(module import), 尽管import/ export 并未在全部浏览器中支持 但依旧可以正常使用，因为webpack将会将其替换为ES5兼容的代码。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#但webpack-不会更改除了-import-export除外的代码-如果需要使用ES6语法-请使用babel-转译器。"><span class="nav-number">1.2.2.</span> <span class="nav-text">但webpack 不会更改除了 import / export除外的代码 如果需要使用ES6语法 请使用babel 转译器。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-使用带有配置的-webpack"><span class="nav-number">1.3.</span> <span class="nav-text">1.2 使用带有配置的 webpack</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#对于复杂配置-我们可以使用一个配置文件-webpack会根据配置文件来打包代码创建一个-webpack-config-js"><span class="nav-number">1.3.1.</span> <span class="nav-text">对于复杂配置  我们可以使用一个配置文件 webpack会根据配置文件来打包代码创建一个 webpack.config.js</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#webpack-config-js"><span class="nav-number">1.3.2.</span> <span class="nav-text">webpack.config.js</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#此文件可以被webpack运行"><span class="nav-number">1.3.3.</span> <span class="nav-text">此文件可以被webpack运行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-配合npm-使用"><span class="nav-number">1.4.</span> <span class="nav-text">1.3 配合npm 使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#考虑到用cli-这种方式来运行webpack-不是特别方便-可以设置快捷方式"><span class="nav-number">1.4.1.</span> <span class="nav-text">考虑到用cli 这种方式来运行webpack 不是特别方便 可以设置快捷方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#现在你可以通过使用-npm-run-build，命令来实现与上面相同的效果，-npm-通过命令选取脚本，并临时修补执行环境，使脚本可以在运行时包含bin-命令-。-你可以在很多项目中看到这种使用习惯。"><span class="nav-number">1.4.2.</span> <span class="nav-text">现在你可以通过使用 npm run build，命令来实现与上面相同的效果， npm 通过命令选取脚本，并临时修补执行环境，使脚本可以在运行时包含bin 命令 。 你可以在很多项目中看到这种使用习惯。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-安装"><span class="nav-number">1.5.</span> <span class="nav-text">2. 安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#前提条件"><span class="nav-number">1.5.1.</span> <span class="nav-text">前提条件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#在开始前，-先要确认已安装Node-js的最新版本。建议使用最新LTS-使用旧版本-可能会遇到各种问题，-因为它们可能缺少webpack功能或缺少相关package包。"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">在开始前， 先要确认已安装Node.js的最新版本。建议使用最新LTS, 使用旧版本 可能会遇到各种问题， 因为它们可能缺少webpack功能或缺少相关package包。</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#本地安装"><span class="nav-number">1.5.2.</span> <span class="nav-text">本地安装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#如果你在项目中使用-npm-执行脚本-npm-首先会在你的本地模块中寻找webpack。"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">如果你在项目中使用 npm 执行脚本 npm 首先会在你的本地模块中寻找webpack。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#上面是npm的标准配置-也是我们推荐的实践。"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">上面是npm的标准配置 也是我们推荐的实践。</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#全局安装-全局安装会锁定webpack到指定版本"><span class="nav-number">1.5.3.</span> <span class="nav-text">全局安装(全局安装会锁定webpack到指定版本)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack-命令可以全局执行了"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">webpack 命令可以全局执行了.</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#体验最新版本"><span class="nav-number">1.5.4.</span> <span class="nav-text">体验最新版本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-生产环境构建"><span class="nav-number">1.6.</span> <span class="nav-text">3. 生产环境构建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#自动方式"><span class="nav-number">1.6.1.</span> <span class="nav-text">自动方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#运行webpack-p-也可以运行-webpack-optimize-minimize-define-process-enc-NODE-ENV-quot-39-production-39-quot-他们是等效的-。"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">运行webpack -p(也可以运行 webpack --optimize-minimize --define process.enc.NODE_ENV="'production'", 他们是等效的)。</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-1-JS-文件压缩"><span class="nav-number">1.6.1.1.1.</span> <span class="nav-text">1.1 JS 文件压缩</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#webpack自带了-UglifyJsPlugin-运行UglifyJS-来压缩输出文具文件。-此插件支持所有的UglifyJS选项。在命令行中指定-–optimize-minimize-或在plugins配置中添加："><span class="nav-number">1.6.1.1.1.1.</span> <span class="nav-text">webpack自带了 UglifyJsPlugin, 运行UglifyJS 来压缩输出文具文件。 此插件支持所有的UglifyJS选项。在命令行中指定 –optimize-minimize 或在plugins配置中添加：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Node环境变量"><span class="nav-number">1.6.2.</span> <span class="nav-text">Node环境变量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#运行webpack-p-或者-define-process-env-NODE-ENV-quot-39-production-39-quot-会通过如下方式调用-DefinePlugin"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">运行webpack -p(或者 --define process.env.NODE_ENV="'production'") 会通过如下方式调用 DefinePlugin</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lztylionheart</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      本站访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      本站总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  









  
  <script type="text/javascript" src="https://cdn.staticfile.org/jquery/2.2.4/jquery.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.staticfile.org/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.staticfile.org/velocity/1.4.1/velocity.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.staticfile.org/velocity/1.4.1/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.staticfile.org/fancybox/2.1.5/jquery.fancybox.pack.js"></script>

  
  <script type="text/javascript" src="/lib/three/three.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  






  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.1"></script>



  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("JjjgnngR4vBSmYjIlA0XYMVb-gzGzoHsz", "bQ9CHtq6mieTKUja6b9zExJs");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

</body>
</html>
